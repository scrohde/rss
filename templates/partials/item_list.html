{{define "item_list"}}
  <section class="items">
    <div class="items-header">
      <div>
        <div class="items-title">{{.Feed.Title}}</div>
        <div class="items-observability">
          <span class="items-refresh-meta">
            <span id="item-last-refresh">Last refresh: {{.Feed.LastRefreshDisplay}}</span>
            <button
              class="items-refresh-button"
              type="button"
              aria-label="Refresh feed {{.Feed.Title}}"
              title="Refresh feed"
              hx-post="/feeds/{{.Feed.ID}}/refresh"
              hx-target="closest section"
              hx-swap="outerHTML"
            >
              <img class="icon" src="/static/icons/refresh-circle.svg" alt="" aria-hidden="true">
            </button>
          </span>
          {{if .Feed.LastError}}
            <span class="items-error">Last error: {{.Feed.LastError}}</span>
          {{end}}
        </div>
      </div>
      <div class="item-actions">
        <button class="chip ghost" hx-post="/feeds/{{.Feed.ID}}/items/read" hx-target="closest section" hx-swap="outerHTML">
          Mark all read
        </button>
        <button
          class="items-sweep-button"
          type="button"
          aria-label="Clear read items"
          title="Clear read items"
          hx-post="/feeds/{{.Feed.ID}}/items/sweep"
          hx-target="closest section"
          hx-swap="outerHTML"
        >
          <img class="icon" src="/static/icons/broom.svg" alt="" aria-hidden="true">
        </button>
      </div>
    </div>
    {{template "new_items_banner" .NewItems}}
    <input type="hidden" id="cursor" name="after_id" value="{{.NewestID}}">
    <div class="poller" hx-get="/feeds/{{.Feed.ID}}/items/poll" hx-trigger="every 60s" hx-target="#new-items-banner" hx-swap="outerHTML" hx-include="#cursor"></div>
    <div class="item-list" id="item-list" tabindex="-1">
      {{range .Items}}
        {{template "item_compact" .}}
      {{else}}
        <div class="empty-state small">
          <h3>No items yet.</h3>
          <p>Try refreshing the feed or subscribe to another source.</p>
        </div>
      {{end}}
    </div>
  </section>
{{end}}
