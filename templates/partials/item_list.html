{{define "item_list"}}
  <section class="items">
    <div class="items-header">
      <div>
        <div class="items-title">{{.Feed.Title}}</div>
        <div class="items-meta">{{.Feed.ItemCount}} items - Latest updates first</div>
        <div class="items-observability">
          <span>Last checked: {{.Feed.LastCheckedDisplay}}{{if .Feed.LastDurationDisplay}} ({{.Feed.LastDurationDisplay}}){{end}}</span>
          {{if .Feed.LastError}}
            <span class="items-error">Last error: {{.Feed.LastError}}</span>
          {{end}}
        </div>
      </div>
      <div class="item-actions">
        <button class="chip ghost" hx-post="/feeds/{{.Feed.ID}}/items/read" hx-target="closest section" hx-swap="outerHTML">
          Mark all read
        </button>
      </div>
    </div>
    {{template "new_items_banner" .NewItems}}
    <input type="hidden" id="cursor" name="after_id" value="{{.NewestID}}">
    <div class="poller" data-poll-aligned="true" hx-get="/feeds/{{.Feed.ID}}/items/poll" hx-trigger="refresh" hx-target="#new-items-banner" hx-swap="outerHTML" hx-include="#cursor"></div>
    <div class="item-list" id="item-list">
      {{range .Items}}
        {{template "item_compact" .}}
      {{else}}
        <div class="empty-state small">
          <h3>No items yet.</h3>
          <p>Try refreshing the feed or subscribe to another source.</p>
        </div>
      {{end}}
    </div>
  </section>
{{end}}
